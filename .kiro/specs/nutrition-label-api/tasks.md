# 구현 계획

- [x] 1. 프로젝트 구조 설정 및 기본 FastAPI 애플리케이션 생성
  - 기존 main.py를 백업하고 새로운 구조로 재구성
  - FastAPI 애플리케이션 초기화 및 기본 설정
  - 환경 변수 및 설정 관리 시스템 구현
  - _요구사항: 6.1, 6.2, 6.3_

- [x] 2. 데이터 모델 정의 및 요청/응답 스키마 구현
  - Pydantic 모델로 요청 스키마 (AnalyzeRequest) 구현
  - Spring DB 구조에 맞는 응답 스키마 (AnalyzeResponse, NutritionInfo) 구현
  - 오류 응답 모델 구현
  - _요구사항: 1.1, 4.6, 4.7, 4.8, 4.9_

- [x] 3. 이미지 다운로드 서비스 구현
  - URL에서 이미지를 다운로드하는 ImageDownloadService 클래스 구현
  - 이미지 형식 검증 및 크기 제한 기능 구현
  - 네트워크 오류 및 타임아웃 처리
  - _요구사항: 2.1, 3.1, 5.3_

- [x] 4. OCR 서비스 구현
  - Google Cloud Vision API를 사용한 OCRService 클래스 구현
  - 기존 extract_text_with_vision 함수를 클래스 메서드로 리팩토링
  - 비동기 처리 및 오류 처리 개선
  - _요구사항: 2.2, 3.2, 5.1_

- [x] 5. AI 검증 서비스 구현
  - 단일 이미지 검증을 위한 ValidationService.validate_single_image 메서드 구현
  - 이미지 쌍 연관성 검증을 위한 ValidationService.validate_image_pair 메서드 구현
  - 기존 검증 로직을 클래스 구조로 리팩토링
  - _요구사항: 2.3, 2.4, 3.3, 3.4_

- [x] 6. AI 분석 서비스 구현
  - Gemini AI를 사용한 AnalysisService.analyze_nutrition_info 메서드 구현
  - Spring DB 구조에 맞는 영양성분 필드명으로 프롬프트 수정
  - 제품명 정규화 및 영양성분 값 추출 로직 구현
  - _요구사항: 4.1, 4.2, 4.3, 4.4, 4.5_

- [x] 7. 메인 API 엔드포인트 구현
  - POST /analyze 엔드포인트 구현
  - 단일 이미지 처리 플로우 구현
  - 이중 이미지 처리 플로우 구현
  - decodeStatus 상태 관리 로직 구현
  - _요구사항: 1.2, 1.3, 1.4, 1.5_

- [ ] 8. 포괄적인 오류 처리 및 로깅 시스템 구현
  - 구조화된 로깅 서비스 구현
  - HTTP 상태 코드별 오류 처리 구현
  - 외부 API 오류에 대한 적절한 응답 처리
  - 요청/응답 로깅 및 성능 메트릭 수집
  - _요구사항: 5.1, 5.2, 5.3, 5.4, 5.5_

- [ ] 9. API 문서화 및 헬스체크 엔드포인트 추가
  - OpenAPI 문서 자동 생성 설정
  - /health 엔드포인트 구현
  - API 사용 예시 및 응답 예시 문서화
  - _요구사항: 6.4_

- [ ] 10. 단위 테스트 및 통합 테스트 구현
  - 각 서비스 클래스에 대한 단위 테스트 작성
  - Mock을 사용한 외부 API 의존성 테스트
  - 전체 API 엔드포인트에 대한 통합 테스트 작성
  - 다양한 시나리오 (성공, 실패, 취소) 테스트 케이스 구현
  - _요구사항: 모든 요구사항 검증_

- [ ] 11. 설정 파일 및 배포 준비
  - requirements.txt 업데이트
  - Docker 설정 검토 및 업데이트
  - 환경 변수 설정 가이드 문서 작성
  - _요구사항: 6.1, 6.2, 6.3_

- [ ] 12. 기존 코드 정리 및 최종 통합 테스트
  - 기존 main.py 백업 파일 정리
  - 전체 시스템 통합 테스트 실행
  - 성능 테스트 및 최적화
  - 코드 리뷰 및 문서화 완료
  - _요구사항: 모든 요구사항 최종 검증_